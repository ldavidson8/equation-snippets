<div class="flex gap-1 pt-4" data-id="color-bars">
  {
    [...Array(30)].map((_, i) => (
      <div
        class="h-5 w-1"
        style={{
          backgroundColor: `hsl(${(i * 360) / 30}, 70%, 60%)`,
        }}
      />
    ))
  }
</div>

<script>
  const prefersReducedMotion = window.matchMedia('(prefers-reduced-motion: reduce)')

  function animateBars() {
    if (prefersReducedMotion.matches) return

    const container = document.querySelector('[data-id="color-bars"]')
    const colorBars = container?.querySelectorAll('div')

    if (!container) return
    if (!colorBars) return

    container.classList.add('animated')

    colorBars.forEach((bar, index) => {
      bar.style.transitionDelay = `${index * 0.02}s`

      requestAnimationFrame(() => {
        bar.style.opacity = '1'
        bar.style.transform = 'scaleY(1)'
      })
    })
  }

  if (document.readyState === 'loading') {
    document.addEventListener('DOMContentLoaded', animateBars)
  } else {
    animateBars()
  }
  document.addEventListener('astro:page-load', animateBars)
</script>

<style>
  [data-id='color-bars'] > div {
    opacity: 0;
    transform: scaleY(0.1);
    transform-origin: bottom;
  }

  [data-id='color-bars'].animated > div {
    transition: all 0.2s ease-out;
  }
</style>
